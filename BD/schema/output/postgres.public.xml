<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<database name="postgres" schema="public" type="PostgreSQL - 13.6 (Debian 13.6-1.pgdg110+1)">
   <sequences>
      <sequence increment="1" name="account_id_seq" startValue="1"/>
      <sequence increment="1" name="planned_task_id_seq" startValue="1"/>
   </sequences>
   <tables>
      <table name="account" numRows="0" remarks="アカウント情報。ユーザの登録済みアカウント情報を保持する。" schema="public" type="TABLE">
         <column autoUpdated="true" defaultValue="nextval('account_id_seq'::regclass)" digits="0" id="0" name="id" nullable="false" remarks="識別子。" size="19" type="bigserial" typeCode="-5">
            <child column="account_id" foreignKey="failed_auth_account_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="failed_auth"/>
            <child column="account_id" foreignKey="planned_task_account_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="planned_task"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="username" nullable="false" remarks="ユーザー名。メールアドレスの形式で保持する。ログインIDとしても使用される。" size="256" type="varchar" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="password" nullable="false" remarks="パスワード。ハッシュ化された状態で保持する。" size="60" type="varchar" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="3" name="roles" nullable="false" remarks="権限。1アカウントで複数の権限を保有している" size="30" type="_varchar" typeCode="2003"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="4" name="is_locked" nullable="false" remarks="アカウントロックBool値。true=ロックされている。false=ロックされていない" size="1" type="bool" typeCode="-7"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="tz" nullable="false" remarks="タイムゾーン" size="10" type="varchar" typeCode="12"/>
         <column autoUpdated="false" defaultValue="CURRENT_TIMESTAMP" digits="6" id="6" name="created_time" nullable="false" remarks="作成日時" size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="CURRENT_TIMESTAMP" digits="6" id="7" name="updated_time" nullable="false" remarks="更新日時" size="35" type="timestamptz" typeCode="93"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="account_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <index name="account_username_key" unique="true">
            <column ascending="true" name="username"/>
         </index>
      </table>
      <table name="executed_task" numRows="0" remarks="実行済みタスク情報。" schema="public" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="planned_task_id" nullable="false" remarks="計画済みタスクID。" size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="executed_task_planned_task_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="planned_task"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="6" id="1" name="started_time" nullable="true" remarks="開始された日時。" size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="6" id="2" name="ended_time" nullable="true" remarks="終了された日時。" size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="false" digits="0" id="3" name="is_achieved" nullable="false" remarks="計画を予定通り実行できたか。true=達成, false=未達成" size="1" type="bool" typeCode="-7"/>
         <primaryKey column="planned_task_id" sequenceNumberInPK="1"/>
         <index name="executed_task_pkey" unique="true">
            <column ascending="true" name="planned_task_id"/>
         </index>
      </table>
      <table name="failed_auth" numRows="0" remarks="認証失敗イベント。アカウントのロックアウト機能で用いるために、認証失敗時に残す情報" schema="public" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="account_id" nullable="false" remarks="アカウントID。" size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="failed_auth_account_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="account"/>
         </column>
         <column autoUpdated="false" defaultValue="CURRENT_TIMESTAMP" digits="6" id="1" name="auth_ts" nullable="false" remarks="認証失敗時のタイムスタンプ" size="35" type="timestamptz" typeCode="93"/>
         <primaryKey column="account_id" sequenceNumberInPK="1"/>
         <primaryKey column="auth_ts" sequenceNumberInPK="2"/>
         <index name="failed_auth_pkey" unique="true">
            <column ascending="true" name="account_id"/>
            <column ascending="true" name="auth_ts"/>
         </index>
      </table>
      <table name="mergin_time" numRows="0" remarks="タスク計画時の支払いが発生しないマージンの時間。例）計画済みタスク±5分が実行完了とするの時間。この±5分を表す。" schema="public" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="6" id="0" name="second" nullable="false" remarks="分。" size="49" type="interval" typeCode="1111"/>
      </table>
      <table name="payment_job_history" numRows="0" remarks="支払いのジョブ履歴。" schema="public" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="planned_task_id" nullable="false" remarks="計画済みタスクID。" size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="payment_job_history_planned_task_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="planned_task"/>
         </column>
         <column autoUpdated="false" defaultValue="CURRENT_TIMESTAMP" digits="6" id="1" name="executed_time" nullable="false" remarks="ジョブが実行された日時。" size="35" type="timestamptz" typeCode="93"/>
         <primaryKey column="planned_task_id" sequenceNumberInPK="1"/>
         <index name="payment_job_history_pkey" unique="true">
            <column ascending="true" name="planned_task_id"/>
         </index>
      </table>
      <table name="planned_task" numRows="0" remarks="計画済みタスク情報。" schema="public" type="TABLE">
         <column autoUpdated="true" defaultValue="nextval('planned_task_id_seq'::regclass)" digits="0" id="0" name="id" nullable="false" remarks="識別子。" size="19" type="bigserial" typeCode="-5">
            <child column="planned_task_id" foreignKey="executed_task_planned_task_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="executed_task"/>
            <child column="planned_task_id" foreignKey="payment_job_history_planned_task_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="payment_job_history"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="account_id" nullable="false" remarks="アカウントID。" size="19" type="int8" typeCode="-5">
            <parent column="id" foreignKey="planned_task_account_id_fkey" implied="false" onDeleteCascade="true" schema="public" table="account"/>
         </column>
         <column autoUpdated="false" defaultValue="null" digits="0" id="2" name="title" nullable="false" remarks="タイトル。" size="100" type="varchar" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="6" id="3" name="start_time" nullable="false" remarks="開始日時。" size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="6" id="4" name="end_time" nullable="false" remarks="終了日時。" size="35" type="timestamptz" typeCode="93"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="5" name="cost" nullable="false" remarks="金額" size="131089" type="numeric" typeCode="2"/>
         <primaryKey column="id" sequenceNumberInPK="1"/>
         <index name="planned_task_pkey" unique="true">
            <column ascending="true" name="id"/>
         </index>
         <checkConstraint constraint="(((CURRENT_TIMESTAMP &lt;= start_time) AND (start_time &lt; end_time)))" name="planned_task_check"/>
         <checkConstraint constraint="(((CURRENT_TIMESTAMP &lt;= end_time) AND (start_time &lt; end_time)))" name="planned_task_check1"/>
         <checkConstraint constraint="((0.0 &lt; cost))" name="planned_task_cost_check"/>
         <checkConstraint constraint="(((title)::text &lt;&gt; ''::text))" name="planned_task_title_check"/>
      </table>
      <table name="roles" numRows="0" remarks="権限情報。認可に使用する権限。" schema="public" type="TABLE">
         <column autoUpdated="false" defaultValue="null" digits="0" id="0" name="role_value" nullable="false" remarks="ロール値。" size="30" type="varchar" typeCode="12"/>
         <column autoUpdated="false" defaultValue="null" digits="0" id="1" name="role_label" nullable="false" remarks="ロール表示名。" size="30" type="varchar" typeCode="12"/>
      </table>
   </tables>
</database>
